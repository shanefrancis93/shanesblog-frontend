<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Research Pipeline</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f7fa;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 20px;
    }
    
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }
    
    p.instruction {
      text-align: center;
      color: #666;
      font-style: italic;
      margin-bottom: 20px;
    }
    
    svg {
      display: block;
      margin: 0 auto;
      max-width: 100%;
    }
    
    .node rect {
      stroke: #333;
      stroke-width: 1.5px;
    }
    
    .node text {
    font-size: 14px;
    font-weight: bold;
    text-anchor: middle;
    alignment-baseline: middle;
}

    .link {
      fill: none;
      stroke: #666;
      stroke-width: 1.5px;
    }
    
    .link-label {
      font-size: 12px;
      fill: #666;
      text-anchor: middle;
    }
    
    .main-node {
      fill: #3d5a80;
    }
    
    .clickable-node {
      fill: #ee6c4d;
      cursor: pointer;
    }
    
    .output-node {
      fill: #98c1d9;
    }
    
    .white-text {
      fill: white;
    }
    
    .dark-text {
      fill: #333;
    }
    
    .hidden {
      display: none;
    }
    
    #back-btn {
      display: none;
      margin-bottom: 20px;
      padding: 8px 16px;
      background-color: #3d5a80;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    
    #back-btn:hover {
      background-color: #2c3e50;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Research Pipeline</h1>
    <p class="instruction">Click on orange components to see detailed views</p>
    
    <button id="back-btn">Back to Main View</button>
    
    <div id="main-view">
      <svg width="600" height="650" viewBox="0 0 600 650">
        <!-- Main Diagram -->
        <!-- Research Problem -->
        <g class="node" transform="translate(300, 50)">
          <rect class="output-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="dark-text">Research Problem</text>
        </g>
        
        <!-- Research Pipeline -->
        <g class="node" transform="translate(300, 120)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Research Pipeline</text>
        </g>
        
        <!-- LLM Orchestration Layer -->
        <g class="node clickable" data-view="llm-view" transform="translate(300, 200)">
          <rect class="clickable-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">LLM Orchestration Layer</text>
        </g>
        
        <!-- Research Template -->
        <g class="node" transform="translate(300, 270)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Research Template</text>
        </g>
        
        <!-- Deep Research Model -->
        <g class="node" transform="translate(300, 340)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Deep Research Model</text>
        </g>
        
        <!-- Knowledge Infrastructure -->
        <g class="node clickable" data-view="knowledge-view" transform="translate(300, 410)">
          <rect class="clickable-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Knowledge Infrastructure</text>
        </g>
        
        <!-- Augmented Research Composition -->
        <g class="node" transform="translate(300, 480)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Augmented Research Composition</text>
        </g>
        
        <!-- Final Research Output -->
        <g class="node" transform="translate(300, 550)">
          <rect class="output-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="dark-text">Final Research Output</text>
        </g>
        
        <!-- Instructions -->
        <g class="node" transform="translate(300, 600)">
          <text class="dark-text">Click on orange components for details</text>
        </g>
        
        <!-- Edges -->
        <g class="links">
          <!-- A to B -->
          <line class="link" x1="300" y1="75" x2="300" y2="95"></line>
          <polygon points="300,95 296,87 304,87" fill="#666"></polygon>
          
          <!-- B to C -->
          <line class="link" x1="300" y1="145" x2="300" y2="175"></line>
          <polygon points="300,175 296,167 304,167" fill="#666"></polygon>
          
          <!-- C to D -->
          <line class="link" x1="300" y1="225" x2="300" y2="245"></line>
          <polygon points="300,245 296,237 304,237" fill="#666"></polygon>
          <text class="link-label" x="325" y="235">Populates</text>
          
          <!-- D to E -->
          <line class="link" x1="300" y1="295" x2="300" y2="315"></line>
          <polygon points="300,315 296,307 304,307" fill="#666"></polygon>
          <text class="link-label" x="340" y="305">Processed by</text>
          
          <!-- E to F -->
          <line class="link" x1="300" y1="365" x2="300" y2="385"></line>
          <polygon points="300,385 296,377 304,377" fill="#666"></polygon>
          <text class="link-label" x="330" y="375">Stored in</text>
          
          <!-- F to G -->
          <line class="link" x1="300" y1="435" x2="300" y2="455"></line>
          <polygon points="300,455 296,447 304,447" fill="#666"></polygon>
          <text class="link-label" x="325" y="445">Enables</text>
          
          <!-- G to C (Feedback, dashed) -->
          <path class="link" d="M 200,480 Q 150,340 200,200" stroke-dasharray="5,5"></path>
          <polygon points="200,200 196,208 204,208" fill="#666"></polygon>
          <text class="link-label" x="140" y="340">Feedback</text>
          
          <!-- G to H -->
          <line class="link" x1="300" y1="505" x2="300" y2="525"></line>
          <polygon points="300,525 296,517 304,517" fill="#666"></polygon>
        </g>
      </svg>
    </div>
    
    <div id="llm-view" class="hidden">
      <svg width="600" height="650" viewBox="0 0 600 650">
        <!-- LLM Orchestration Layer Diagram -->
        <g class="node" transform="translate(300, 50)">
          <rect class="clickable-node" x="-150" y="-25" width="300" height="50" rx="5" ry="5"></rect>
          <text class="white-text">LLM Orchestration Layer</text>
        </g>
        
        <g class="node" transform="translate(300, 130)">
          <rect class="main-node" x="-150" y="-25" width="300" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Epistemic Task Decomposition</text>
        </g>
        
        <g class="node" transform="translate(150, 210)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Task Profiles</text>
        </g>
        
        <g class="node" transform="translate(450, 210)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Model Capability Profiles</text>
        </g>
        
        <g class="node" transform="translate(300, 290)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Bidding System</text>
        </g>
        
        <g class="node" transform="translate(300, 370)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Task Allocation</text>
        </g>
        
        <g class="node" transform="translate(150, 450)">
          <rect style="fill: #FFD166;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="dark-text">Model A Tasks</text>
        </g>
        
        <g class="node" transform="translate(300, 450)">
          <rect style="fill: #06D6A0;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Model B Tasks</text>
        </g>
        
        <g class="node" transform="translate(450, 450)">
          <rect style="fill: #118AB2;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Model C Tasks</text>
        </g>
        
        <g class="node" transform="translate(300, 530)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Template Population</text>
        </g>
        
        <!-- Return Button -->
        <g class="node clickable" data-return="true" transform="translate(300, 600)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Return to Main View</text>
        </g>
        
        <!-- Edges -->
        <g class="links">
          <line class="link" x1="300" y1="75" x2="300" y2="105"></line>
          <polygon points="300,105 296,97 304,97" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="155" x2="200" y2="185"></line>
          <polygon points="200,185 204,177 196,177" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="155" x2="400" y2="185"></line>
          <polygon points="400,185 396,177 404,177" fill="#666"></polygon>
          
          <line class="link" x1="200" y1="235" x2="250" y2="265"></line>
          <polygon points="250,265 246,257 254,257" fill="#666"></polygon>
          
          <line class="link" x1="400" y1="235" x2="350" y2="265"></line>
          <polygon points="350,265 354,257 346,257" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="315" x2="300" y2="345"></line>
          <polygon points="300,345 296,337 304,337" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="395" x2="200" y2="425"></line>
          <polygon points="200,425 204,417 196,417" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="395" x2="300" y2="425"></line>
          <polygon points="300,425 296,417 304,417" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="395" x2="400" y2="425"></line>
          <polygon points="400,425 396,417 404,417" fill="#666"></polygon>
          
          <line class="link" x1="150" y1="475" x2="250" y2="505"></line>
          <polygon points="250,505 246,497 254,497" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="475" x2="300" y2="505"></line>
          <polygon points="300,505 296,497 304,497" fill="#666"></polygon>
          
          <line class="link" x1="450" y1="475" x2="350" y2="505"></line>
          <polygon points="350,505 354,497 346,497" fill="#666"></polygon>
        </g>
      </svg>
    </div>
    
    <div id="knowledge-view" class="hidden">
      <svg width="600" height="650" viewBox="0 0 600 650">
        <!-- Knowledge Infrastructure Diagram -->
        <g class="node" transform="translate(300, 50)">
          <rect class="clickable-node" x="-150" y="-25" width="300" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Knowledge Infrastructure</text>
        </g>
        
        <g class="node" transform="translate(150, 130)">
          <rect style="fill: #023047;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Vector Database System</text>
        </g>
        
        <g class="node" transform="translate(450, 130)">
          <rect style="fill: #023047;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Query System</text>
        </g>
        
        <g class="node" transform="translate(300, 210)">
          <rect style="fill: #219ebc;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Document Processing</text>
        </g>
        
        <g class="node" transform="translate(150, 290)">
          <rect style="fill: #219ebc;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Embedding Generation</text>
        </g>
        
        <g class="node" transform="translate(450, 290)">
          <rect style="fill: #219ebc;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Semantic Search</text>
        </g>
        
        <g class="node" transform="translate(300, 370)">
          <rect style="fill: #219ebc;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">RAG Integration</text>
        </g>
        
        <g class="node" transform="translate(300, 450)">
          <rect style="fill: #8ecae6;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="dark-text">LLM Context Provision</text>
        </g>
        
        <g class="node" transform="translate(300, 530)">
          <rect style="fill: #8ecae6;" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="dark-text">Model Query Responses</text>
        </g>
        
        <!-- Return Button -->
        <g class="node clickable" data-return="true" transform="translate(300, 600)">
          <rect class="main-node" x="-100" y="-25" width="200" height="50" rx="5" ry="5"></rect>
          <text class="white-text">Return to Main View</text>
        </g>
        
        <!-- Edges -->
        <g class="links">
          <line class="link" x1="300" y1="75" x2="200" y2="105"></line>
          <polygon points="200,105 204,97 196,97" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="75" x2="400" y2="105"></line>
          <polygon points="400,105 396,97 404,97" fill="#666"></polygon>
          
          <line class="link" x1="200" y1="155" x2="250" y2="185"></line>
          <polygon points="250,185 246,177 254,177" fill="#666"></polygon>
          
          <line class="link" x1="400" y1="155" x2="350" y2="185"></line>
          <polygon points="350,185 354,177 346,177" fill="#666"></polygon>
          
          <line class="link" x1="250" y1="235" x2="200" y2="265"></line>
          <polygon points="200,265 204,257 196,257" fill="#666"></polygon>
          
          <line class="link" x1="350" y1="235" x2="400" y2="265"></line>
          <polygon points="400,265 396,257 404,257" fill="#666"></polygon>
          
          <line class="link" x1="200" y1="315" x2="250" y2="345"></line>
          <polygon points="250,345 246,337 254,337" fill="#666"></polygon>
          
          <line class="link" x1="400" y1="315" x2="350" y2="345"></line>
          <polygon points="350,345 354,337 346,337" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="395" x2="300" y2="425"></line>
          <polygon points="300,425 296,417 304,417" fill="#666"></polygon>
          
          <line class="link" x1="300" y1="475" x2="300" y2="505"></line>
          <polygon points="300,505 296,497 304,497" fill="#666"></polygon>
        </g>
      </svg>
    </div>
  </div>

  <script>
    // Simple vanilla JavaScript to handle view switching
    document.addEventListener('DOMContentLoaded', function() {
      const mainView = document.getElementById('main-view');
      const llmView = document.getElementById('llm-view');
      const knowledgeView = document.getElementById('knowledge-view');
      const backBtn = document.getElementById('back-btn');
      
      // Clickable nodes in the main view
      const clickableNodes = document.querySelectorAll('.node.clickable');
      
      clickableNodes.forEach(node => {
        node.addEventListener('click', function() {
          const viewToShow = this.getAttribute('data-view');
          const shouldReturn = this.getAttribute('data-return');
          
          if (shouldReturn) {
            // Return to main view
            mainView.classList.remove('hidden');
            llmView.classList.add('hidden');
            knowledgeView.classList.add('hidden');
            backBtn.style.display = 'none';
          } else if (viewToShow) {
            // Show specific view
            mainView.classList.add('hidden');
            llmView.classList.add('hidden');
            knowledgeView.classList.add('hidden');
            document.getElementById(viewToShow).classList.remove('hidden');
            backBtn.style.display = 'block';
            
            // Send message to parent page to scroll to the corresponding section
            sendMessageToParent(viewToShow);
          }
        });
      });
      
      // Back button functionality
      backBtn.addEventListener('click', function() {
        mainView.classList.remove('hidden');
        llmView.classList.add('hidden');
        knowledgeView.classList.add('hidden');
        backBtn.style.display = 'none';
        
        // Send message to parent to scroll back to the main diagram section
        sendMessageToParent('main');
      });
      
      // Function to send messages to the parent page
      function sendMessageToParent(componentId) {
        // Map view IDs to component names that match the markdown headings
        const componentMap = {
          'llm-view': '3-multi-llm-orchestration-to-implement',
          'knowledge-view': '2-vector-database-integration-to-implement',
          'main': 'interactive-diagram'
        };
        
        // Get the mapped component name or use the original if not found
        const mappedComponent = componentMap[componentId] || componentId;
        
        // Log the message being sent (for debugging)
        console.log('Sending message to parent:', mappedComponent);
        
        // Send the message to the parent window
        window.parent.postMessage({
          type: 'componentClick',
          componentId: mappedComponent
        }, '*');
      }
      
      // Notify parent that diagram is loaded
      window.parent.postMessage({
        type: 'diagramLoaded'
      }, '*');
    });
  </script>
</body>
</html>